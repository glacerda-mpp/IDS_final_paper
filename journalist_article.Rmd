---
title: "Is Diversity and Inclusion Fostered on Professors' Syllabi?"
author: "Rodrigo Bola√±os, Eduardo Campbell and Guilherme Lacerda"
output:
  html_document:
    theme: cerulean
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

pacman::p_load(rmdformats, tidyverse, stringr, pdftools, gender, ggplot2, quanteda.sentiment, quanteda, tidyr, gridExtra, tm, gender) #add here the libraries you are using
library(quanteda)
library(quanteda.sentiment)
library(ggplot2)
```

```{r,fig.align='left', echo=F, out.width = "100%", fig.cap= "Image Credits: Hertie School diversity and inclusion website"}

knitr::include_graphics("hertieDEI.jpg")
```



```{r functions, echo=FALSE}
#functions #this should be hidden


##1. Diversity statement function##

read_div_statement <- function(syllabus_pdf){
  
  #Cut it by lines
  syllabus_l<-scan(textConnection(syllabus_pdf), what="character",sep = "\n")
  #make it a dataframe 
  syllabus_df<-as.data.frame(unlist(syllabus_l)) 
  #change name of column
  names(syllabus_df)[1] <- "lines"
  #syllabus_df<-tolower(lines)
  
  #find the Diversity statement line
  diversity_line<-grep("Diversity Statement", syllabus_df$lines)
  
  if (length(diversity_line)==0) {
    #Diversity statement
    diversity_line<-grep("Diversity statement", syllabus_df$lines)
  } 
  #find the Grading line
  assignment_line<- grep("Grading and Assignments", syllabus_df$lines)
  
  if(length(diversity_line)!=0)
  {
  #the diversity statement is between these tw
   diversity_df<-syllabus_df %>%
    slice((diversity_line+1):(assignment_line-1))
  
  #take out those lines that have exactly one character 
  diversity_df<-diversity_df %>%
    filter(nchar(as.character(lines))!=1)

  #create a string
  div_statement<-paste(diversity_df$lines,collapse=" ")
  
  div_statement<- div_statement %>%str_remove(.,"[:digit:]") %>% str_trim(.)
  } else{
    div_statement="NULL"
  }
  div_statement
}


#. 2. Split readings function

split_readings<-function(complete_df,no_c){ #1
  for (i in 22:33){ #2
    add_readings<-as.data.frame(complete_df[no_c,i])
    names(add_readings)[1]<-"readings"
    
    if (i==22) { #3
      split_readings_df<-rbind(add_readings)
    }else{  #3 - #4
      split_readings_df<-rbind(split_readings_df,add_readings)
    }  #4  
    
  } #2

  split_readings_df<-as.data.frame(unlist(split_readings_df))
  names(split_readings_df)[1]<-"reading_list"
  
  split_readings_df<-split_readings_df%>%
    mutate(reading_list=str_trim(reading_list))
  
  split_readings_df
  
} 

##3. Split names function

split_names<-function(readings_l){
  
  for (i in 1:nrow(readings_l)) {
    
    a<-word(readings_l[i,1],1) %>%
      str_remove(.,"[:punct:]") %>%
      str_trim(.)
    
    b<-word(readings_l[i,1],2) %>%
      str_remove(.,"[:punct:]")%>%
      str_trim(.)
    
    names_df<-data.frame(a,b)
    names(names_df)[1]<-"last_name"
    names(names_df)[2]<-"name_name"
    
    if (i==1) { 
      final_names_df<-rbind(names_df)
    }else{
      final_names_df<-rbind(final_names_df,names_df)
    }  
  }
  
  final_names_df
}

##4. Percentage of females ###

percentage_female<-function(reading_names) {
  
  list_names<-reading_names$name_name
  
  list_names<-list_names %>%
    str_remove(.,"[:punct:]")%>%
    str_trim(.)
  
  count_a<-gender(list_names)%>%
    group_by(gender) %>%
    summarise(n=n()/nrow(.))
  
  if (nrow(count_a)==2) {
    result<-unlist(count_a[1,2])
  }else{
   result<-0
    }
  
  
  result
}

```


```{r load-diversity-statements}

working_directory<-getwd()
list_syllabi<-list.files("./syllabi_pdfs")
pdfs<-map(paste0(working_directory,"/syllabi_pdfs/",list_syllabi),pdf_text)
a<-map(pdfs,read_div_statement)
div_statement_df<-data.frame(unlist(list_syllabi),unlist(a))

```

```{r getting-readings, include=FALSE}

## Integrating diversity statement scrapping data frame to second data frame with courses' basic and readings information 

gathered_courses_data_vf <- read_csv("gathered_courses_data_vf.csv") ## uploading gathered information about Professors and readings

complete_df <- div_statement_df %>%  ## Including key column for left join
  mutate(observation = 1:n())

complete_df <- dplyr::left_join(complete_df, gathered_courses_data_vf, by = "observation") ## Left joining information to complete data frame

## complete_df<-readr::read_csv("div_stats_last.csv") ## Delete before turning in

complete_df<-complete_df %>%
  mutate(sep_read_1=str_split(Readings_1,";"))

complete_df<-complete_df %>%
  mutate(sep_read_2=str_split(Readings_2,";"))

complete_df<-complete_df %>%
  mutate(sep_read_3=str_split(Readings_3,";"))

complete_df<-complete_df %>%
  mutate(sep_read_4=str_split(Readings_4,";"))

complete_df<-complete_df %>%
  mutate(sep_read_5=str_split(Readings_5,";"))

complete_df<-complete_df %>%
  mutate(sep_read_6=str_split(Readings_6,";"))

complete_df<-complete_df %>%
  mutate(sep_read_7=str_split(Readings_7,";"))

complete_df<-complete_df %>%
  mutate(sep_read_8=str_split(Readings_8,";"))

complete_df<-complete_df %>%
  mutate(sep_read_9=str_split(Readings_9,";"))

complete_df<-complete_df %>%
  mutate(sep_read_10=str_split(Readings_10,";"))

complete_df<-complete_df %>%
  mutate(sep_read_11=str_split(Readings_11,";"))

complete_df<-complete_df %>%
  mutate(sep_read_12=str_split(Readings_12,";"))






readings_bauer<-split_readings(complete_df,1)
reading_list_bauer<-split_names(readings_bauer)


readings_ahrens<-split_readings(complete_df,2)
reading_list_ahrens<-split_names(readings_ahrens)


readings_gruener<-split_readings(complete_df,3)
reading_list_gruener<-split_names(readings_gruener)

readings_lancker<-split_readings(complete_df,4)
reading_list_lancker<-split_names(readings_lancker)

readings_patz<-split_readings(complete_df,5)
reading_list_patz<-split_names(readings_patz)

readings_jachten<-split_readings(complete_df,6)
reading_list_jachten<-split_names(readings_jachten)

readings_costello<-split_readings(complete_df,7)
reading_list_costello<-split_names(readings_costello)

readings_bosch<-split_readings(complete_df,8)
reading_list_bosch<-split_names(readings_bosch)

readings_bobic<-split_readings(complete_df,9)
reading_list_bobic<-split_names(readings_bobic)

readings_wucher<-split_readings(complete_df,10) #this is missing
reading_list_wucher<-split_names(readings_wucher)


readings_dkt<-split_readings(complete_df,11) #this is missing
reading_list_dkt<-split_names(readings_dkt)

readings_hassel<-split_readings(complete_df,12)
reading_list_hassel<-split_names(readings_hassel)


readings_hickman<-split_readings(complete_df,13)
reading_list_hickman<-split_names(readings_hickman)

readings_graf<-split_readings(complete_df,14)
reading_list_graf<-split_names(readings_graf)

readings_migliorati<-split_readings(complete_df,15)
reading_list_migliorati<-split_names(readings_migliorati)


readings_hustedt<-split_readings(complete_df,16)
reading_list_hustedt<-split_names(readings_hustedt)

readings_parrado<-split_readings(complete_df,17)
reading_list_parrado<-split_names(readings_parrado)

readings_wegrich<-split_readings(complete_df,18)
reading_list_wegrich<-split_names(readings_wegrich)

readings_kayser<-split_readings(complete_df,19)
reading_list_kayser<-split_names(readings_kayser)

readings_munzert<-split_readings(complete_df,20)
reading_list_munzert<-split_names(readings_munzert)


bauer_female<-percentage_female(reading_list_bauer)

ahrens_female<-percentage_female(reading_list_ahrens)

costello_female<-percentage_female(reading_list_costello)
gruener_female<-percentage_female(reading_list_gruener)

lancker_female<-reading_list_lancker%>%
  percentage_female(.)

patz_female<-patz_female<-reading_list_patz%>%
  percentage_female(.)

jacthen_female<-reading_list_jachten%>%
  percentage_female(.)

costello_female<-reading_list_costello%>%
  percentage_female(.)

bosch_female<-reading_list_bosch%>%
  percentage_female(.)

bobic_female<-reading_list_bobic%>%
  percentage_female(.)

wucher_female<-reading_list_wucher%>%
  percentage_female(.)

dkt_female<-reading_list_dkt%>%
  percentage_female(.)

hassel_female<-reading_list_hassel%>%
  percentage_female(.)

hickman_female<-reading_list_hickman%>%
  percentage_female(.)

graf_female<-reading_list_graf%>%
  percentage_female(.)

migliorati_female<-reading_list_migliorati%>%
  percentage_female(.)

hustedt_female<-reading_list_hustedt%>%
  percentage_female(.)

parrado_female<-reading_list_parrado%>%
  percentage_female(.)

wegrich_female<-reading_list_wegrich%>%
  percentage_female(.)

kayser_female<-reading_list_kayser%>%
  percentage_female(.)

munzert_female<-reading_list_munzert%>%
  percentage_female(.)




classes_1<-c("Bauer_internationalorganizations.pdf","econIIeconomiccrises_Ahrens.pdf",
             "econIIfinmarketpolicy_Gruener.pdf","econIIsustainability_Lancker.pdf",
             "globalgov_Patz_Rev.pdf","globalgoveu_Jachtenfuchs.pdf",
             "international_law_CaliCostello.pdf",
             "introduction_to_economics_Bosch-Rosa.pdf",
             "lawgovernanceruleoflawcrisis_Bobic.pdf",
             "NOinternationalsecurity_Gohdes_Wucherpfennig.pdf",
             "NOlawgov_Dawson-Kurban-Thielborger.pdf","policyprocess_welfareemployment_Hassel.pdf",
             "policyprocessclimate_Hickmann_Fuhr.pdf","policyprocesseduclaborecon_Graf.pdf",
             "policyprocesseu_Migliorati.pdf","public_mgmt_hustedt.pdf","public_mgmt_Parrado.pdf",
             "public_mgmt_Wegrich.pdf","statistics1_Kayser.pdf","statisticsII_Munzert.pdf")


female_list<-c(bauer_female,ahrens_female,gruener_female,lancker_female,patz_female,
            jacthen_female,costello_female,bosch_female,bobic_female,wucher_female,
            dkt_female,hassel_female,hickman_female,graf_female,migliorati_female,
            hustedt_female,parrado_female,wegrich_female,kayser_female,munzert_female)


female_df<-data.frame(classes_1,female_list)

```


## Introduction: 

In the last couple of years, the Hertie School publicly expressed its commitment towards diversity and inclusion. This was exemplified by creation of the Diversity and Inclusion Task Force 2019 that aimed to identify general strategic objectives for the school, including definitions of equality, diversity and inclusion; identify action and issue-area specific goals; and recommend measures to achieve the goals identified. Despite these efforts, the university faced internal and external criticism and outrage sparked by an article posted by a professor that compared BLM protestors removing statues to barbarians. As a result, students expressed their discontent not only by the article published but also due to the lack of diversity and inclusion at the university. According to Karim Fereidooni, a professor at the Ruhr-University in Bochum who focuses on critical race theory in education, ‚ÄúGerman universities need to employ more people who are familiar with racism, and they need to do more to hire a diverse workforce.‚Äù

Even though issues related to racism are far from being solved at the university, the Hertie School has made clear efforts on other areas of diversity and inclusion. To ameliorate gender gaps in higher education, the faculty body pledged to not to participate in ‚Äúmen-only‚Äù panels; and a commitment to host more inclusive events at the Hertie School. Moreover, there is a strategy to recruit more women in faculty, and soon the university will officially appoint its first female president Dr. Cornelia Woll. 

As noted, the Hertie School is committed to improve its diversity and inclusion strategy, especially regarding gender equality and equity. Nevertheless, these commitments seem to be mostly administrative and little is known about the outcomes of such efforts on the student body. Consequently, we, three Master‚Äôs of Public Policy students, conducted a course audit in order to figure out some diversity and inclusion indicators on the course syllabi. 

The main question we aim to explore on the course audit was: how is diversity and inclusion fostered on the course syllabus? 


## Motivation and Relevance 

```{r, out.width= "50%", out.extra='style="float:right; padding:10px"'}

knitr::include_graphics("dani.jpg")
```


Diversity and inclusion is a phrase that has gained increasing popularity among the Hertie Administration and higher education institutions as a whole. However, it is often referred to as an abstract concept or value that is part of the university experience without clear metrics on how to increase, implement and strengthen policies that aim to foster such value. While it is true that the university leadership is committed to ameliorate the experiences of students regarding diversity and inclusion, there is often a disconnect if that commitment is translating to the daily lives of students at the university. For that reason, students conducted a research project to investigate how diversity and inclusion is cultivated and strengthened on the courses‚Äô syllabi. 

While diversity and inclusion has become a trendy topic among several organizations, its importance is crucial when training policy makers. Hertie as a policy school must guarantee an integral training in policy making, meaning that it should actively promote an intersectional diversity and inclusion approach to its teaching curricula. 

## Methodology and Data Collection

We selected the course syllabus of first year compulsory classes of fall and spring 2020-2021. This was identified by looking at the [course directory](https://mystudies.hertie-school.org/en/course-directory.php) provided by Hertie's administration website and selecting the core courses which are named "GRAD-C". After that, we created a data source with the gender and research method of the instructors per syllabus. However, we dropped the syllabus from classes that were taught by more than one professors who are not from the same gender. That was done in order to standardize our data set for the purpose of the analysis. The project was divided into two parts: 
-Analyzing the diversity statements and identifying relationships between gender  and research method of the professor, statement length and type of words used
-Looking at the authors of required readings, finding out the overall gender representation, and identifying relationships between gender representation of authors, gender of the instructor, and research method of the instructor.  



## Finding and Analysis

```{r analysis}
## 1. Duplicating data frame and reorganizing for analysis purposes

analysis_df <- complete_df

analysis_df[16, "Key"] <- "GRAD-C3H" # Differentiating GRAD-C3 keys (same course, different Professors)
analysis_df[17, "Key"] <- "GRAD-C3P" # Differentiating GRAD-C3 keys (same course, different Professors)
analysis_df[18, "Key"] <- "GRAD-C3W" # Differentiating GRAD-C3 keys (same course, different Professors)

analysis_df <- analysis_df[-c(10,11), ] # Removing classes taught jointly by both male and female Professor

vec_word_count <- sapply(strsplit(analysis_df$unlist.a., " "), length) # Creating vector with diversity statement word count
analysis_df$word_count <- vec_word_count  # Including vector in data frame


## 2. Plotting relationships

## 2.1 Average length of diversity statement

# Plot about average length of diversity statement according to Prof gender
ave_count_gender_plot <- ggplot(data = analysis_df, aes(x = Gender, y = word_count, fill = Gender)) +
  geom_bar(stat = "summary", fun = "mean") +
  labs(title = "Average Length of Diversity Statement",
       subtitle = "Comparison Between Professors' Gender",
       x = "Grouping of Professors  \n by Gender",
       y = "Length of Statement (Words)") +
  scale_fill_manual(values = c("Female" = "#a52a2a", "Male" = "#2aa5a5")) +
  theme(axis.text.x=element_blank(), legend.position="bottom",
        plot.subtitle = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5)) +
  theme_minimal() +
  coord_cartesian(ylim = c(0, 90))

# Plot about average length of diversity statement according to Prof research method
ave_count_method_plot <- ggplot(data = analysis_df, aes(x = Method, y = word_count, fill = Method)) +
  geom_bar(stat = "summary", fun = "mean") +
  labs(title = "Average Length of Diversity Statement",
       subtitle = "Comparison Between Professors' Main Research Method",
       x = "Grouping of Professors  \n by Research Method",
       y = "Length of Statement (Words)") +
  scale_fill_manual(values = c("Quali" = "#a0740a", "Quant" = "#0a36a0")) +
  theme(axis.text.x=element_blank(), legend.position="bottom",
        plot.subtitle = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5)) +
  theme_minimal() +
  coord_cartesian(ylim = c(0, 90))

# Plot about average length of diversity statement according to Prof field
ave_count_field_plot <- ggplot(data = analysis_df, aes(x = Field, y = word_count, fill = Field)) +
  geom_bar(stat = "summary", fun = "mean") +
  labs(title = "Average Length of Diversity Statement",
       subtitle = "Comparison Between Professors' Fields",
       x = "Grouping of Professors  \n  by Field",
       y = "Length of Statement (Words)") +
  scale_fill_manual(values = c("STEM" = "#cd5c5c", "Social science" = "#5ccdcd")) +
  theme(axis.text.x=element_blank(), legend.position="bottom",
        plot.subtitle = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5)) +
  theme_minimal() +
  coord_cartesian(ylim = c(0, 90))

# Decision: not to include "Field" as it carries the same information as "Method".

# Image combining gender and method plots (average length)
comparison_averages_plot <- grid.arrange(ave_count_gender_plot,  ## Combining plots for summary image (average length)
                                     ave_count_method_plot,
                                     ncol = 2)


## 2.2 Length of diversity statement by individual course

# Plot with individual course statement length filled by Gender
count_class_gender_plot <- ggplot(data = analysis_df, aes(x = reorder(Key, word_count), y = word_count, fill = Gender)) +
  geom_bar(stat="identity") +
  theme(axis.text.x = element_text(angle = 90),
        plot.subtitle = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5)) +
  labs(title = "Length of Diversity Statement",
       subtitle = "Filling according to \nProfessors' Gender",
       x = "Mandatory Courses",
       y = "Length of Statement (Words)") +
  scale_fill_manual(values = c("Female" = "#a52a2a", "Male" = "#2aa5a5")) +
  theme_classic() +
  coord_cartesian(ylim = c(0, 150)) +
  theme(axis.text.x = element_text(angle = 90))

# Plot with individual course statement length filled by Method
count_class_method_plot <- ggplot(data = analysis_df, aes(x = reorder(Key, word_count), y = word_count, fill = Method)) +
  geom_bar(stat="identity") +
  theme(axis.text.x = element_text(angle = 90),
        plot.subtitle = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5)) +
  labs(title = "Length of Syllabi Diversity Statement",
       subtitle = "Filling according to \nProfessors' Main Research Method",
       x = "Mandatory Courses",
       y = "Length of Statement (Words)") +
  scale_fill_manual(values = c("Quali" = "#a0740a", "Quant" = "#0a36a0")) +
  theme_classic() +
  coord_cartesian(ylim = c(0, 150)) +
  theme(axis.text.x = element_text(angle = 90))

# Plot with individual course statement length filled by Field - not included as carries same information as Method.
count_class_field_plot <- ggplot(data = analysis_df, aes(x = reorder(Key, word_count), y = word_count, fill = Field)) +
  geom_bar(stat="identity") +
  theme(axis.text.x = element_text(angle = 90))

# Image combining gender and method plots (individual course length)
comparison_courses_plot <- grid.arrange(count_class_gender_plot, ## Combining plots for summary image (word count per class)
             count_class_method_plot, ncol = 2)

## 3. Applying dictionaries

# 3.1 Checking Quanteda package's existing dictionary

# Removing classes without diversity statement from the analysis
dictionary_df <- analysis_df[!(analysis_df$word_count=="1"), ] # Removing classes with no diversity statement

# Working with Quanteda package's valence-based sentiment dictionary
sentiment_df <- dictionary_df$unlist.a. %>%
  textstat_valence(dictionary = data_dictionary_AFINN) # Creating new data frame with valence-based sentiment values

dictionary_df$sentiment <- sentiment_df$sentiment # Inserting sentiment column in original data frame

sentiment_plot <- ggplot(data = dictionary_df, ## Plotting sentiment by class
         aes(x = sentiment, y = reorder(Key, sentiment), color = Gender)) +
  geom_point() +
  ylab("")

# Plot with "sentiment" by class according to Quanteda package
# sentiment_plot      ## Decide if we're using it for analysis


## 3.2 Creating our own diversity dictionary

# Creating the diversity-specific dictionary
dict_div <-
  dictionary(list(
    diversity_words = c(
      "race", "racism", "racist", "racial", "racially",
      "gender",
      "ethnicity", "ethnical", "ethnically",
      "ability", "ableism",
      "discrimination", "discriminatory",
      "culture", "cultural", "culturally",
      "belief",
      "equity",
      "underrepresented"
    ),
    speech_words = c("speech",
                     "freedom",
                     "thought",
                     "debate",
                     "disagreement", "agreement",
                     "respectful", "respecftully"),
    practice_words = c("projects",
                       "governments",
                       "countries"
  )))

## 3.2.1 Analysis of the diversity dictionary weighted by diversity statement length

# Creating a dfm using the dictionary above, weighting it by document length and computing the share of words of interest
dfm_div_wgt <- dictionary_df$unlist.a. %>%
  tokens(remove_punct = TRUE, remove_numbers = TRUE) %>%
  dfm() %>%
  dfm_weight(scheme = "prop") %>%
  dfm_lookup(dict_div)

# Transforming the dfm into a data frame (and tidying it up) in order to plot the findings
div_wgt_df <- dfm_div_wgt %>%
  convert(to = "data.frame") %>%
  cbind(docvars(dfm_div_wgt)) %>%
  tidyr::gather(unlist.a., share, c(diversity_words,speech_words,practice_words))

## Including the courses' keys to the new data frame
div_wgt_df$Key <- dictionary_df$Key

# Plotting the findings
div_dict_wgt_plot <- div_wgt_df %>%
  ggplot(aes(x = Key, y = share, color = unlist.a.)) +
  geom_point() +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90),
        plot.subtitle = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5)) +
  labs(title = "Share of Diversity Statement Composed by Key Words",
       subtitle = "Filling according to \nthe Approach to Diversity",
       y = "Share of Document",
       x = "Mandatory courses") +
  scale_color_manual(name = "Approaches to Diversity",
                     labels=c(diversity_words = "Representativeness and Equity",
                              practice_words = "Practical experience",
                              speech_words = "Freedom of Speech"),
                     values = palette()) +
  coord_flip()

div_dict_wgt_plot


## 3.2.3 Analysis of the diversity dictionary based on absolute number of key word occurrences

# Creating an absolute dfm using the dictionary
dfm_div_abs <- dictionary_df$unlist.a. %>%
  tokens(remove_punct = TRUE, remove_numbers = TRUE) %>%
  dfm() %>%
  dfm_lookup(dict_div)

## Transforming a second dfm into a data frame (and tidying it up) in order to plot the findings
div_abs_df <- dfm_div_abs %>%
  convert(to = "data.frame") %>%
  cbind(docvars(dfm_div_abs)) %>%
  tidyr::gather(unlist.a., share, c(diversity_words,speech_words,practice_words))

## Including the courses' keys to the new data frame
div_abs_df$Key <- dictionary_df$Key

# Plotting the findings
div_dict_abs_plot <- div_abs_df %>%
  ggplot(aes(x = Key, y = share, color = unlist.a.)) +
  geom_point() +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90),
                      plot.subtitle = element_text(hjust = 0.5),
                      plot.title = element_text(hjust = 0.5)) +
  labs(title = "Absolute # of Key Words Employed on Diversity Statement",
       subtitle = "Filling according to \nthe Approach to Diversity",
       y = "# of Key Words Employed (Occurrence)",
       x = "Mandatory courses") +
  scale_color_manual(name = "Approaches to Diversity",
                     labels=c(diversity_words = "Representativeness and Equity",
                              practice_words = "Practical experience",
                              speech_words = "Freedom of Speech"),
                     values = palette()) +
  coord_flip()

div_dict_abs_plot

# Image combining gender and method plots (individual course length)

comparison_diversity_plot <- grid.arrange(div_dict_abs_plot,
                                       div_dict_wgt_plot, ncol = 1, nrow = 2)


## 5. Analyzing female 

# Completing data frame for analysis

female_df <- female_df %>%  ## Including key column for left join
  mutate(observation = 1:n())

female_df <- dplyr::left_join(female_df, gathered_courses_data_vf, by = "observation") ## Left joining information to complete data frame

female_df[16, "Key"] <- "GRAD-C3H" # Differentiating GRAD-C3 keys (same course, different Professors)
female_df[17, "Key"] <- "GRAD-C3P" # Differentiating GRAD-C3 keys (same course, different Professors)
female_df[18, "Key"] <- "GRAD-C3W" # Differentiating GRAD-C3 keys (same course, different Professors)

female_df <- female_df[-c(10,11), ] # Removing classes taught jointly by both male and female Professor

# Plot comparing female % of readings for individual courses while identifying professors' gender
readings_gender_plot <- ggplot(data = female_df, aes(x = reorder(Key, female_list), y = female_list, fill = Gender)) +
  geom_col(stat="identity") +
  theme(axis.text.x = element_text(angle = 90),
        plot.subtitle = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5)) +
  labs(title = "Female authors in required readings",
       subtitle = "Filling according to \nProfessors' Gender",
       x = "Mandatory Courses",
       y = "Female authors in required readings (%)") +
  scale_fill_manual(values = c("Female" = "#a52a2a", "Male" = "#2aa5a5")) +
  scale_y_continuous(labels = scales::percent_format(scale = 100)) +
  theme_minimal() +
  theme(panel.grid.minor.x=element_blank(),
           panel.grid.major.x=element_blank()) +
  theme(axis.text.x = element_text(angle = 90))

readings_gender_plot

# Plot comparing female % of readings for individual courses while identifying professors' method
readings_method_plot <- ggplot(data = female_df, aes(x = reorder(Key, female_list), y = female_list, fill = Method)) +
  geom_col(stat="identity") +
  theme(axis.text.x = element_text(angle = 90),
        plot.subtitle = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5)) +
  labs(title = "Female authors in required readings",
       subtitle = "Filling according to \nProfessors' Method",
       x = "Mandatory Courses",
       y = "Female authors in required readings (%)") +
  scale_fill_manual(values = c("Quali" = "#a0740a", "Quant" = "#0a36a0")) +
  scale_y_continuous(labels = scales::percent_format(scale = 100)) +
  theme_minimal() +
  theme(panel.grid.minor.x=element_blank(),
           panel.grid.major.x=element_blank()) +
  theme(axis.text.x = element_text(angle = 90))

readings_method_plot 

# Image combining gender and method plots (female author % in readings)
comparison_female_plot <- grid.arrange(readings_gender_plot,
                                     readings_method_plot,
                                     ncol = 2, nrow = 1)

# For printing these grid.arranges in a RMarkdown file it seems necessary to
# save it as a file and then call such file
# https://stackoverflow.com/questions/17059099/saving-grid-arrange-plot-to-file
```

## Policy Recommendations 

## References

